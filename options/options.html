<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Reviewer Settings</title>
    <link rel="stylesheet" href="options.css">
</head>
<body>
    <div class="container">
        <h1>‚öôÔ∏è Story Reviewer Settings</h1>
        
        <div class="section api-config-section">
            <div class="section-header">
                <h2>üîå LLM API Configuration</h2>
                <div class="help-toggle" id="apiHelpToggle">
                    <span class="help-icon">?</span>
                    <span class="help-text">Show help</span>
                </div>
            </div>
            
            <div class="contextual-help" id="apiHelp">
                <div class="help-content">
                    <h4>üîë Getting API Keys:</h4>
                    <div class="help-links">
                        <div class="help-item">
                            <strong>OpenAI:</strong> <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com/api-keys</a>
                        </div>
                        <div class="help-item">
                            <strong>Anthropic:</strong> <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a>
                        </div>
                        <div class="help-item">
                            <strong>Mistral:</strong> <a href="https://console.mistral.ai/" target="_blank">console.mistral.ai</a>
                        </div>
                    </div>
                    <div class="security-note">
                        üîí <strong>Security:</strong> Your API key is stored securely in your browser and never shared with third parties.
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="apiProvider">API Provider:</label>
                <select id="apiProvider">
                    <option value="openai">OpenAI</option>
                    <option value="anthropic">Anthropic (Claude)</option>
                    <option value="mistral">Mistral AI</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="apiKey">API Key:</label>
                <input type="password" id="apiKey" placeholder="Enter your API key">
                <button type="button" id="toggleApiKey" class="toggle-btn">Show</button>
            </div>
            
            <div class="form-group">
                <label for="modelSelect">Model:</label>
                <select id="modelSelect">
                    <option value="">Select a model...</option>
                </select>
                <div class="model-help" id="modelHelp"></div>
            </div>
            
            <div class="form-group">
                <label for="temperature">Temperature:</label>
                <input type="number" id="temperature" min="0" max="2" step="0.1" value="0.7" placeholder="0.7">
                <div class="field-help">Controls randomness: 0.0 = focused, 2.0 = creative (default: 0.7)</div>
            </div>
            
            <div class="form-group">
                <button type="button" id="testConnection" class="test-btn">Test Connection</button>
                <span id="connectionStatus" class="status"></span>
            </div>
        </div>
        
        <div class="section prompts-section">
            <div class="section-header">
                <h2>üìù Custom Prompt Template</h2>
                <div class="section-description">Customize the AI prompt template</div>
            </div>
            
            <div class="prompt-content">
                <div class="form-group">
                    <textarea id="customPrompt" placeholder="Enter your custom prompt template. Use {{storyContent}} for story content, {{timestamp}} for current time, and {{provider}} for API provider name." rows="10"></textarea>
                    <div class="character-count">
                        <span id="promptCharCount">0</span> characters
                    </div>
                </div>
                
                <div class="prompt-actions">
                    <button type="button" id="previewPrompt" class="preview-btn">Preview Prompt</button>
                    <button type="button" id="resetPrompt" class="reset-prompt-btn">Reset to Default</button>
                </div>
                
                <div class="prompt-variables">
                    <h4>Available Variables:</h4>
                    <div class="variable-help-text">Click any variable to copy to clipboard</div>
                    <div class="variable-list">
                        <button type="button" class="variable-tag" data-variable="{{storyContent}}">
                            <span class="variable-name">{{storyContent}}</span>
                            <span class="variable-desc">Story content</span>
                        </button>
                        <button type="button" class="variable-tag" data-variable="{{timestamp}}">
                            <span class="variable-name">{{timestamp}}</span>
                            <span class="variable-desc">Current time</span>
                        </button>
                        <button type="button" class="variable-tag" data-variable="{{provider}}">
                            <span class="variable-name">{{provider}}</span>
                            <span class="variable-desc">API provider</span>
                        </button>
                        <button type="button" class="variable-tag" data-variable="{{feedbackType}}">
                            <span class="variable-name">{{feedbackType}}</span>
                            <span class="variable-desc">Feedback type</span>
                        </button>
                    </div>
                </div>
                
                <div class="import-export-section">
                    <h4>Import/Export Prompts</h4>
                    <div class="import-export-description">Save your custom prompts or restore from backup files</div>
                    <div class="import-export-actions">
                        <button type="button" id="exportPrompts" class="export-btn">Export All Prompts</button>
                        <button type="button" id="importPrompts" class="import-btn">Import Prompts</button>
                        <input type="file" id="importFile" accept=".json" style="display: none;">
                    </div>
                </div>
                
                <div id="promptValidation" class="validation-message"></div>
            </div>
        </div>
        
        <div id="statusMessage" class="status-message"></div>
    </div>
    
    <!-- Preview Modal -->
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Prompt Preview</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="preview-content">
                    <h4>Final Prompt:</h4>
                    <div id="previewText" class="preview-text"></div>
                    <button type="button" id="copyPreview" class="copy-btn">Copy to Clipboard</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="options.js"></script>
</body>
</html>