<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Story Reviewer Settings</title>
    <link rel="stylesheet" href="options.css">
</head>
<body>
    <div class="container">
        <h1>Story Reviewer Settings</h1>
        
        <div class="section">
            <h2>LLM API Configuration</h2>
            <div class="form-group">
                <label for="apiProvider">API Provider:</label>
                <select id="apiProvider">
                    <option value="openai">OpenAI</option>
                    <option value="anthropic">Anthropic (Claude)</option>
                    <option value="custom">Custom API</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="apiKey">API Key:</label>
                <input type="password" id="apiKey" placeholder="Enter your API key">
                <button type="button" id="toggleApiKey" class="toggle-btn">Show</button>
            </div>
            
            <div class="form-group" id="customEndpointGroup" style="display: none;">
                <label for="customEndpoint">Custom API Endpoint:</label>
                <input type="url" id="customEndpoint" placeholder="https://api.example.com/v1/chat/completions">
            </div>
            
            <div class="form-group">
                <button type="button" id="testConnection" class="test-btn">Test Connection</button>
                <span id="connectionStatus" class="status"></span>
            </div>
        </div>
        
        <div class="section">
            <h2>Custom Prompts</h2>
            <div class="prompt-tabs">
                <button class="prompt-tab active" data-provider="openai">OpenAI</button>
                <button class="prompt-tab" data-provider="anthropic">Anthropic</button>
                <button class="prompt-tab" data-provider="custom">Custom API</button>
            </div>
            
            <div class="prompt-content">
                <div class="form-group">
                    <label for="customPrompt">Prompt Template:</label>
                    <textarea id="customPrompt" placeholder="Enter your custom prompt template. Use {{storyContent}} for story content, {{timestamp}} for current time, and {{provider}} for API provider name." rows="10"></textarea>
                    <div class="character-count">
                        <span id="promptCharCount">0</span> characters
                    </div>
                </div>
                
                <div class="prompt-variables">
                    <h4>Available Variables:</h4>
                    <div class="variable-list">
                        <span class="variable-tag">{{storyContent}}</span>
                        <span class="variable-tag">{{timestamp}}</span>
                        <span class="variable-tag">{{provider}}</span>
                        <span class="variable-tag">{{feedbackType}}</span>
                    </div>
                </div>
                
                <div class="prompt-actions">
                    <button type="button" id="previewPrompt" class="preview-btn">Preview Prompt</button>
                    <button type="button" id="resetPrompt" class="reset-prompt-btn">Reset to Default</button>
                </div>
                
                <div id="promptValidation" class="validation-message"></div>
            </div>
        </div>
        
        <div class="section">
            <h2>Instructions</h2>
            <div class="instructions">
                <h3>Getting API Keys:</h3>
                <ul>
                    <li><strong>OpenAI:</strong> Visit <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com/api-keys</a></li>
                    <li><strong>Anthropic:</strong> Visit <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a></li>
                    <li><strong>Custom API:</strong> Contact your API provider for endpoint URL and authentication details</li>
                </ul>
                <p><strong>Note:</strong> Your API key is stored securely in your browser and never shared with third parties.</p>
            </div>
        </div>
        
        <div class="actions">
            <button type="button" id="saveSettings" class="save-btn">Save Settings</button>
            <button type="button" id="resetSettings" class="reset-btn">Reset to Defaults</button>
        </div>
        
        <div id="statusMessage" class="status-message"></div>
    </div>
    
    <!-- Preview Modal -->
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Prompt Preview</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="preview-content">
                    <h4>Final Prompt:</h4>
                    <div id="previewText" class="preview-text"></div>
                    <button type="button" id="copyPreview" class="copy-btn">Copy to Clipboard</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="options.js"></script>
</body>
</html>